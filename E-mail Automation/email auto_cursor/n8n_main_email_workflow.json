{
  "name": "ÌïôÌöå Ïù¥Î©îÏùº ÏûêÎèôÌôî - Î©îÏù∏ ÏõåÌÅ¨ÌîåÎ°úÏö∞",
  "nodes": [
    {
      "parameters": {},
      "id": "8b8c1c0b-74dc-4b99-9c2e-0f7f2f5e1234",
      "name": "Manual Trigger",
      "type": "n8n-nodes-base.manualTrigger",
      "typeVersion": 1,
      "position": [
        240,
        300
      ]
    },
    {
      "parameters": {
        "operation": "read",
        "documentId": {
          "__rl": true,
          "value": "",
          "mode": "url"
        },
        "sheetName": "Sheet1",
        "range": "A:G",
        "options": {
          "headerRow": true
        }
      },
      "id": "a1b2c3d4-e5f6-7890-abcd-ef1234567890",
      "name": "Google Sheets - Ï∞∏ÏÑùÏûê Îç∞Ïù¥ÌÑ∞ ÏùΩÍ∏∞",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4,
      "position": [
        460,
        300
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "google-sheets-credential-id",
          "name": "Google Sheets Account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// ÏûÖÎ†• Îç∞Ïù¥ÌÑ∞ Í≤ÄÏ¶ù Î∞è ÌïÑÌÑ∞ÎßÅ\nconst inputData = items[0].json;\nconst validEmails = [];\n\n// Google SheetsÏóêÏÑú ÏùΩÏùÄ Îç∞Ïù¥ÌÑ∞Í∞Ä Î∞∞Ïó¥ ÌòïÌÉúÏù∏ÏßÄ ÌôïÏù∏\nconst rowsData = Array.isArray(inputData) ? inputData : inputData.values || [];\n\nfor (const row of rowsData) {\n  // Ïù¥Î©îÏùº ÌòïÏãù Í≤ÄÏ¶ù\n  const emailRegex = /^[^\\s@]+@[^\\s@]+\\.[^\\s@]+$/;\n  \n  if (emailRegex.test(row.Ïù¥Î©îÏùº) && \n      row.Ïù¥Î¶Ñ && \n      row.Íµ≠Í∞Ä && \n      row.Ï¥àÎ°ùÎì±Í∏â) {\n    \n    // ÌÖúÌîåÎ¶ø ÏÑ†ÌÉù Î°úÏßÅ\n    let templateType = '';\n    let emailSubject = '';\n    let emailBody = '';\n    \n    if (row.Ï¥àÎ°ùÎì±Í∏â === 'A') {\n      templateType = 'premium_invite';\n      emailSubject = `${row.Ïù¥Î¶Ñ}Îãò, ÌîÑÎ¶¨ÎØ∏ÏóÑ ÌïôÌöå Ï∞∏ÏÑù Ï¥àÎåÄ`;\n      emailBody = `ÏïàÎÖïÌïòÏÑ∏Ïöî ${row.Ïù¥Î¶Ñ}Îãò,\\n\\n${row.ÏÜåÏÜç}ÏóêÏÑú Ïò§ÏãúÎäî Í≤ÉÏùÑ ÏßÑÏã¨ÏúºÎ°ú ÌôòÏòÅÌï©ÎãàÎã§.\\n\\nüåü ÌîÑÎ¶¨ÎØ∏ÏóÑ Ï∞∏ÏÑùÏûê ÌäπÏ†Ñ:\\n- VIP ÎùºÏö¥ÏßÄ Ïù¥Ïö©\\n- ÌäπÎ≥Ñ ÎÑ§Ìä∏ÏõåÌÇπ ÏÑ∏ÏÖò\\n- Ïö∞ÏÑ† ÏßàÏùòÏùëÎãµ Í∏∞Ìöå\\n\\nüìç Î∞úÌëú Ï†ïÎ≥¥:\\n- ÏãúÍ∞Ñ: ${row.Î∞úÌëúÏãúÍ∞Ñ}\\n- Ï¥àÎ°ùÎì±Í∏â: ${row.Ï¥àÎ°ùÎì±Í∏â} (ÏµúÏö∞Ïàò)\\n- Travel Grant: ${row.Travel_Grant}\\n\\nÏ∂îÍ∞Ä Î¨∏ÏùòÏÇ¨Ìï≠Ïù¥ ÏûàÏúºÏãúÎ©¥ Ïñ∏Ï†úÎì† Ïó∞ÎùΩ Î∞îÎûçÎãàÎã§.\\n\\nÍ∞êÏÇ¨Ìï©ÎãàÎã§.\\nÌïôÌöå Ïö¥ÏòÅÏßÑ`;\n    } else if (row.Ï¥àÎ°ùÎì±Í∏â === 'B') {\n      templateType = 'standard_invite';\n      emailSubject = `${row.Ïù¥Î¶Ñ}Îãò, ÌïôÌöå Ï∞∏ÏÑù ÏïàÎÇ¥`;\n      emailBody = `ÏïàÎÖïÌïòÏÑ∏Ïöî ${row.Ïù¥Î¶Ñ}Îãò,\\n\\n${row.ÏÜåÏÜç}ÏóêÏÑú Ïò§ÏãúÎäî Í≤ÉÏùÑ ÌôòÏòÅÌï©ÎãàÎã§.\\n\\nüìã Ï∞∏ÏÑù Ï†ïÎ≥¥:\\n- Î∞úÌëúÏãúÍ∞Ñ: ${row.Î∞úÌëúÏãúÍ∞Ñ}\\n- Ï¥àÎ°ùÎì±Í∏â: ${row.Ï¥àÎ°ùÎì±Í∏â}\\n- Travel Grant: ${row.Travel_Grant}\\n\\nÌïôÌöå ÏùºÏ†ï Î∞è ÌîÑÎ°úÍ∑∏Îû®Ïóê ÎåÄÌïú ÏûêÏÑ∏Ìïú Ï†ïÎ≥¥Îäî Ï≤®Î∂ÄÎêú Í∞ÄÏù¥ÎìúÎ•º Ï∞∏Ï°∞Ìï¥ Ï£ºÏÑ∏Ïöî.\\n\\nÍ∞êÏÇ¨Ìï©ÎãàÎã§.\\nÌïôÌöå Ïö¥ÏòÅÏßÑ`;\n    } else {\n      templateType = 'basic_invite';\n      emailSubject = `${row.Ïù¥Î¶Ñ}Îãò, ÌïôÌöå Ï∞∏ÏÑù ÌôïÏù∏`;\n      emailBody = `ÏïàÎÖïÌïòÏÑ∏Ïöî ${row.Ïù¥Î¶Ñ}Îãò,\\n\\n${row.ÏÜåÏÜç}ÏóêÏÑúÏùò Ï∞∏ÏÑùÏùÑ ÌôïÏù∏Ìï©ÎãàÎã§.\\n\\nÍ∏∞Î≥∏ Ï†ïÎ≥¥:\\n- Ï¥àÎ°ùÎì±Í∏â: ${row.Ï¥àÎ°ùÎì±Í∏â}\\n- Travel Grant: ${row.Travel_Grant}\\n\\nÌïôÌöå ÎãπÏùº ÏïàÎÇ¥ÏÇ¨Ìï≠ÏùÑ Ï∂îÌõÑ Î≥ÑÎèÑÎ°ú Î∞úÏÜ°ÎìúÎ¶¨Í≤†ÏäµÎãàÎã§.\\n\\nÍ∞êÏÇ¨Ìï©ÎãàÎã§.\\nÌïôÌöå Ïö¥ÏòÅÏßÑ`;\n    }\n    \n    validEmails.push({\n      name: row.Ïù¥Î¶Ñ,\n      email: row.Ïù¥Î©îÏùº,\n      country: row.Íµ≠Í∞Ä,\n      grade: row.Ï¥àÎ°ùÎì±Í∏â,\n      affiliation: row.ÏÜåÏÜç,\n      presentationTime: row.Î∞úÌëúÏãúÍ∞Ñ,\n      travelGrant: row.Travel_Grant,\n      templateType: templateType,\n      personalizedSubject: emailSubject,\n      personalizedBody: emailBody,\n      processedAt: new Date().toISOString()\n    });\n  } else {\n    // Ïú†Ìö®ÌïòÏßÄ ÏïäÏùÄ Îç∞Ïù¥ÌÑ∞ Î°úÍπÖ\n    console.log(`Invalid data for row: ${JSON.stringify(row)}`);\n  }\n}\n\nconsole.log(`Processed ${validEmails.length} valid emails out of ${rowsData.length} total rows`);\n\nreturn validEmails.map(email => ({ json: email }));"
      },
      "id": "b2c3d4e5-f6a7-8901-bcde-f23456789012",
      "name": "Îç∞Ïù¥ÌÑ∞ Í≤ÄÏ¶ù Î∞è ÌÖúÌîåÎ¶ø ÏÑ†ÌÉù",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        680,
        300
      ]
    },
    {
      "parameters": {
        "operation": "sendEmail",
        "to": "={{ $json.email }}",
        "subject": "={{ $json.personalizedSubject }}",
        "bodyType": "text",
        "body": "={{ $json.personalizedBody }}",
        "options": {
          "priority": "normal"
        }
      },
      "id": "c3d4e5f6-a7b8-9012-cdef-345678901234",
      "name": "Microsoft Outlook - Ïù¥Î©îÏùº Î∞úÏÜ°",
      "type": "n8n-nodes-base.microsoftOutlook",
      "typeVersion": 2,
      "position": [
        900,
        300
      ],
      "credentials": {
        "microsoftOutlookOAuth2Api": {
          "id": "outlook-credential-id",
          "name": "Microsoft Outlook Account"
        }
      }
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "timestamp",
              "value": "={{ $now }}"
            },
            {
              "name": "recipient_email",
              "value": "={{ $json.email }}"
            },
            {
              "name": "recipient_name",
              "value": "={{ $json.name }}"
            },
            {
              "name": "template_type",
              "value": "={{ $json.templateType }}"
            },
            {
              "name": "status",
              "value": "sent"
            },
            {
              "name": "country",
              "value": "={{ $json.country }}"
            },
            {
              "name": "grade",
              "value": "={{ $json.grade }}"
            },
            {
              "name": "affiliation",
              "value": "={{ $json.affiliation }}"
            },
            {
              "name": "presentation_time",
              "value": "={{ $json.presentationTime }}"
            },
            {
              "name": "travel_grant",
              "value": "={{ $json.travelGrant }}"
            }
          ]
        },
        "options": {}
      },
      "id": "d4e5f6a7-b8c9-0123-defa-456789012345",
      "name": "Î∞úÏÜ° Í≤∞Í≥º Î°úÍπÖ",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3,
      "position": [
        1120,
        300
      ]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "email-log",
        "options": {}
      },
      "id": "e5f6a7b8-c9d0-1234-efab-567890123456",
      "name": "Webhook - Î°úÍ∑∏ Ï†ÑÏÜ°",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        1340,
        300
      ],
      "webhookId": "email-automation-log"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "error-condition",
              "leftValue": "={{ $json.error }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "notExists"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "f6a7b8c9-d0e1-2345-fabc-678901234567",
      "name": "Ïò§Î•ò Ï≤òÎ¶¨ Î∂ÑÍ∏∞",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2,
      "position": [
        900,
        480
      ]
    },
    {
      "parameters": {
        "values": {
          "string": [
            {
              "name": "error_timestamp",
              "value": "={{ $now }}"
            },
            {
              "name": "error_recipient",
              "value": "={{ $json.email }}"
            },
            {
              "name": "error_message",
              "value": "Ïù¥Î©îÏùº Î∞úÏÜ° Ïã§Ìå®"
            },
            {
              "name": "error_details",
              "value": "={{ $json.error }}"
            },
            {
              "name": "status",
              "value": "failed"
            }
          ]
        },
        "options": {}
      },
      "id": "a7b8c9d0-e1f2-3456-abcd-789012345678",
      "name": "Ïò§Î•ò Î°úÍπÖ",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3,
      "position": [
        1120,
        580
      ]
    }
  ],
  "connections": {
    "Manual Trigger": {
      "main": [
        [
          {
            "node": "Google Sheets - Ï∞∏ÏÑùÏûê Îç∞Ïù¥ÌÑ∞ ÏùΩÍ∏∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Sheets - Ï∞∏ÏÑùÏûê Îç∞Ïù¥ÌÑ∞ ÏùΩÍ∏∞": {
      "main": [
        [
          {
            "node": "Îç∞Ïù¥ÌÑ∞ Í≤ÄÏ¶ù Î∞è ÌÖúÌîåÎ¶ø ÏÑ†ÌÉù",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Îç∞Ïù¥ÌÑ∞ Í≤ÄÏ¶ù Î∞è ÌÖúÌîåÎ¶ø ÏÑ†ÌÉù": {
      "main": [
        [
          {
            "node": "Microsoft Outlook - Ïù¥Î©îÏùº Î∞úÏÜ°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Microsoft Outlook - Ïù¥Î©îÏùº Î∞úÏÜ°": {
      "main": [
        [
          {
            "node": "Î∞úÏÜ° Í≤∞Í≥º Î°úÍπÖ",
            "type": "main",
            "index": 0
          },
          {
            "node": "Ïò§Î•ò Ï≤òÎ¶¨ Î∂ÑÍ∏∞",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Î∞úÏÜ° Í≤∞Í≥º Î°úÍπÖ": {
      "main": [
        [
          {
            "node": "Webhook - Î°úÍ∑∏ Ï†ÑÏÜ°",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Ïò§Î•ò Ï≤òÎ¶¨ Î∂ÑÍ∏∞": {
      "main": [
        [],
        [
          {
            "node": "Ïò§Î•ò Î°úÍπÖ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "staticData": null,
  "tags": [
    {
      "createdAt": "2025-01-20T10:00:00.000Z",
      "updatedAt": "2025-01-20T10:00:00.000Z",
      "id": "conference-email-automation",
      "name": "ÌïôÌöå Ïù¥Î©îÏùº ÏûêÎèôÌôî"
    }
  ],
  "triggerCount": 1,
  "updatedAt": "2025-01-20T10:00:00.000Z",
  "versionId": "1.0.0"
}
