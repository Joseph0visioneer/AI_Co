# ğŸ”§ YouTube ìë§‰ ë‹¤ìš´ë¡œë” - ê¸°ìˆ  ë¬¸ì„œ ë° ì½”ë“œ ì„¤ëª…

> ê°œë°œìë¥¼ ìœ„í•œ ìƒì„¸ ê¸°ìˆ  ë¬¸ì„œ ë° ì½”ë“œ ì•„í‚¤í…ì²˜ ì„¤ëª…

## ğŸ“‹ ëª©ì°¨
1. [ì•„í‚¤í…ì²˜ ê°œìš”](#ì•„í‚¤í…ì²˜-ê°œìš”)
2. [ì½”ë“œ êµ¬ì¡° ë¶„ì„](#ì½”ë“œ-êµ¬ì¡°-ë¶„ì„)
3. [í•µì‹¬ ê¸°ëŠ¥ ì„¤ëª…](#í•µì‹¬-ê¸°ëŠ¥-ì„¤ëª…)
4. [ì˜ì¡´ì„± ê´€ë¦¬](#ì˜ì¡´ì„±-ê´€ë¦¬)
5. [ì—ëŸ¬ ì²˜ë¦¬ ì „ëµ](#ì—ëŸ¬-ì²˜ë¦¬-ì „ëµ)
6. [í™•ì¥ ê°€ëŠ¥ì„±](#í™•ì¥-ê°€ëŠ¥ì„±)

---

## ì•„í‚¤í…ì²˜ ê°œìš”

### ğŸ—ï¸ ì‹œìŠ¤í…œ êµ¬ì¡°
```mermaid
graph TD
    A[ì‚¬ìš©ì] --> B[youtube-subs ì‰˜ ìŠ¤í¬ë¦½íŠ¸]
    B --> C[youtube_subtitle_downloader.py]
    C --> D[yt-dlp ë¼ì´ë¸ŒëŸ¬ë¦¬]
    D --> E[YouTube API]
    C --> F[ë¡œì»¬ íŒŒì¼ ì‹œìŠ¤í…œ]
    
    B --> G[ê°€ìƒí™˜ê²½ ê´€ë¦¬]
    B --> H[ì˜ì¡´ì„± ì„¤ì¹˜]
    B --> I[ì—ëŸ¬ ì²˜ë¦¬]
```

### ğŸ“ íŒŒì¼ êµ¬ì¡° ë° ì—­í• 

| íŒŒì¼ | ì—­í•  | ì–¸ì–´ |
|------|------|------|
| `youtube-subs` | ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤, í™˜ê²½ ì„¤ì • | Bash |
| `youtube_subtitle_downloader.py` | í•µì‹¬ ë¡œì§, YouTube ì²˜ë¦¬ | Python |
| `requirements.txt` | ì˜ì¡´ì„± ì •ì˜ | Text |
| `README.md` | ì‚¬ìš©ì ë¬¸ì„œ | Markdown |

---

## ì½”ë“œ êµ¬ì¡° ë¶„ì„

### ğŸ Python ì½”ì–´ ëª¨ë“ˆ (`youtube_subtitle_downloader.py`)

#### í´ë˜ìŠ¤ êµ¬ì¡°
```python
class YouTubeSubtitleDownloader:
    """ë©”ì¸ ë‹¤ìš´ë¡œë” í´ë˜ìŠ¤ - ë‹¨ì¼ ì±…ì„ ì›ì¹™ ì ìš©"""
    
    def __init__(self, output_dir: str = "./subtitles")
    def _setup_logging(self) -> None
    def _get_ydl_options(self, video_url: str, language: str) -> Dict[str, Any]
    def download_subtitles(self, video_url: str, language: str) -> bool
    def list_available_languages(self, video_url: str) -> Optional[Dict[str, list]]
```

#### í•µì‹¬ ì„¤ê³„ ì›ì¹™
1. **ë‹¨ì¼ ì±…ì„ ì›ì¹™**: ê° ë©”ì„œë“œëŠ” í•˜ë‚˜ì˜ ê¸°ëŠ¥ë§Œ ë‹´ë‹¹
2. **ì˜ì¡´ì„± ì£¼ì…**: ì¶œë ¥ ë””ë ‰í† ë¦¬ë¥¼ ìƒì„±ìì—ì„œ ì£¼ì…
3. **íƒ€ì… íŒíŒ…**: ëª¨ë“  í•¨ìˆ˜ì— íƒ€ì… ì •ë³´ ì œê³µ
4. **ì—ëŸ¬ ì²˜ë¦¬**: ì˜ˆì™¸ ìƒí™©ì„ ëª…í™•íˆ ì²˜ë¦¬

### ğŸ”§ ì‰˜ ìŠ¤í¬ë¦½íŠ¸ êµ¬ì¡° (`youtube-subs`)

#### ì£¼ìš” í•¨ìˆ˜ë“¤
```bash
# í™˜ê²½ ì„¤ì •
check_dependencies()      # Python, pip ì„¤ì¹˜ í™•ì¸
setup_virtual_environment() # ê°€ìƒí™˜ê²½ ìƒì„±/í™œì„±í™”
install_dependencies()    # íŒ¨í‚¤ì§€ ì„¤ì¹˜

# ì‚¬ìš©ì ì¸í„°í˜ì´ìŠ¤
print_usage()            # ë„ì›€ë§ ì¶œë ¥
validate_url()           # URL ìœ íš¨ì„± ê²€ì‚¬
log_info/success/error() # ì»¬ëŸ¬ ë¡œê¹…

# ë©”ì¸ ë¡œì§
main()                   # ì „ì²´ í”Œë¡œìš° ì œì–´
```

#### Bash ìŠ¤í¬ë¦½íŠ¸ íŠ¹ì§•
- **ì•ˆì „í•œ ì‹¤í–‰**: `set -euo pipefail`ë¡œ ì—„ê²©í•œ ì˜¤ë¥˜ ì²˜ë¦¬
- **ì»¬ëŸ¬ ì¶œë ¥**: ì‚¬ìš©ì ê²½í—˜ í–¥ìƒì„ ìœ„í•œ ìƒ‰ìƒ ì½”ë”©
- **ê°€ìƒí™˜ê²½ ê´€ë¦¬**: Python ì˜ì¡´ì„± ê²©ë¦¬
- **ì¸í„°ëŸ½íŠ¸ ì²˜ë¦¬**: `trap`ì„ í†µí•œ ìš°ì•„í•œ ì¢…ë£Œ

---

## í•µì‹¬ ê¸°ëŠ¥ ì„¤ëª…

### ğŸ¯ ìë§‰ ë‹¤ìš´ë¡œë“œ í”„ë¡œì„¸ìŠ¤

#### 1. URL ê²€ì¦ ë° ì •ë³´ ì¶”ì¶œ
```python
def download_subtitles(self, video_url: str, language: str = 'auto') -> bool:
    # 1. yt-dlp ì˜µì…˜ ì„¤ì •
    ydl_opts = self._get_ydl_options(video_url, language)
    
    # 2. ë¹„ë””ì˜¤ ì •ë³´ ì¶”ì¶œ (ë‹¤ìš´ë¡œë“œ ì—†ì´)
    info = ydl.extract_info(video_url, download=False)
    
    # 3. ìë§‰ ê°€ìš©ì„± í™•ì¸
    subtitles = info.get('subtitles', {})
    auto_subtitles = info.get('automatic_captions', {})
    
    # 4. ì‹¤ì œ ë‹¤ìš´ë¡œë“œ ì‹¤í–‰
    ydl.download([video_url])
```

#### 2. yt-dlp ì˜µì…˜ ìµœì í™”
```python
def _get_ydl_options(self, video_url: str, language: str = 'auto') -> Dict[str, Any]:
    return {
        'writesubtitles': True,        # ìˆ˜ë™ ìë§‰ ë‹¤ìš´ë¡œë“œ
        'writeautomaticsub': True,     # ìë™ ìƒì„± ìë§‰ ë‹¤ìš´ë¡œë“œ
        'subtitleslangs': [language] if language != 'auto' else ['en', 'ko', 'ja'],
        'subtitlesformat': 'srt/best', # SRT í˜•ì‹ ìš°ì„ 
        'outtmpl': str(self.output_dir / '%(title)s.%(ext)s'),
        'skip_download': True,         # ë¹„ë””ì˜¤ëŠ” ë‹¤ìš´ë¡œë“œí•˜ì§€ ì•ŠìŒ
        'ignoreerrors': True,          # ì¼ë¶€ ì˜¤ë¥˜ ë¬´ì‹œí•˜ê³  ê³„ì†
        'quiet': False,                # ì§„í–‰ ìƒí™© í‘œì‹œ
    }
```

### ğŸ” ì–¸ì–´ ê°ì§€ ë° ì²˜ë¦¬

#### ë‹¤êµ­ì–´ ì§€ì› ì „ëµ
```python
# ì–¸ì–´ ìš°ì„ ìˆœìœ„ ì²˜ë¦¬
if language != 'auto':
    # íŠ¹ì • ì–¸ì–´ ìš”ì²­ ì‹œ
    'subtitleslangs': [language]
else:
    # ìë™ ëª¨ë“œ: ì£¼ìš” ì–¸ì–´ë“¤ ì‹œë„
    'subtitleslangs': ['en', 'ko', 'ja']
```

#### ìë§‰ íƒ€ì… êµ¬ë¶„
- **Manual Subtitles**: ì‚¬ëŒì´ ì§ì ‘ ì‘ì„±í•œ ì •í™•í•œ ìë§‰
- **Automatic Captions**: AIê°€ ìë™ ìƒì„±í•œ ìë§‰ (ì •í™•ë„ ë‚®ìŒ)

---

## ì˜ì¡´ì„± ê´€ë¦¬

### ğŸ“¦ requirements.txt ë¶„ì„
```txt
# í•µì‹¬ ì˜ì¡´ì„±
yt-dlp>=2024.1.0          # YouTube ë‹¤ìš´ë¡œë“œ ì—”ì§„

# ì„ íƒì  ì˜ì¡´ì„±
pysrt>=1.1.2              # SRT íŒŒì¼ ì¡°ì‘ (í–¥í›„ í™•ì¥ìš©)
colorama>=0.4.6           # í¬ë¡œìŠ¤ í”Œë«í¼ ì»¬ëŸ¬ ì¶œë ¥
```

### ğŸ”„ ê°€ìƒí™˜ê²½ ì „ëµ
```bash
# ê°€ìƒí™˜ê²½ ìƒì„± ë° ê´€ë¦¬
VENV_DIR="${SCRIPT_DIR}/.venv"

setup_virtual_environment() {
    if [[ ! -d "$VENV_DIR" ]]; then
        python3 -m venv "$VENV_DIR"  # ìƒˆ ê°€ìƒí™˜ê²½ ìƒì„±
    fi
    source "$VENV_DIR/bin/activate"  # í™œì„±í™”
}
```

**ì¥ì :**
- ì‹œìŠ¤í…œ Pythonê³¼ ê²©ë¦¬
- í”„ë¡œì íŠ¸ë³„ ì˜ì¡´ì„± ê´€ë¦¬
- ë²„ì „ ì¶©ëŒ ë°©ì§€

---

## ì—ëŸ¬ ì²˜ë¦¬ ì „ëµ

### ğŸ›¡ï¸ ë‹¤ì¸µ ì—ëŸ¬ ì²˜ë¦¬

#### 1. ì‰˜ ìŠ¤í¬ë¦½íŠ¸ ë ˆë²¨
```bash
set -euo pipefail  # ì—„ê²©í•œ ì˜¤ë¥˜ ì²˜ë¦¬
trap 'log_warning "Download interrupted by user"; exit 130' INT
```

#### 2. Python ë ˆë²¨
```python
try:
    # ë©”ì¸ ë¡œì§
    ydl.download([video_url])
except yt_dlp.DownloadError as e:
    self.logger.error(f"âŒ Download error: {e}")
    return False
except Exception as e:
    self.logger.error(f"âŒ Unexpected error: {e}")
    return False
```

#### 3. ì‚¬ìš©ì ì¹œí™”ì  ë©”ì‹œì§€
```bash
log_error() {
    echo -e "${RED}[ERROR]${NC} $1" >&2
}
```

### ğŸ”§ ì¼ë°˜ì ì¸ ì˜¤ë¥˜ ì‹œë‚˜ë¦¬ì˜¤

| ì˜¤ë¥˜ íƒ€ì… | ê°ì§€ ë°©ë²• | í•´ê²° ë°©ì•ˆ |
|-----------|-----------|-----------|
| ì˜ì¡´ì„± ëˆ„ë½ | `command -v python3` | ìë™ ì„¤ì¹˜ ì•ˆë‚´ |
| ê¶Œí•œ ë¬¸ì œ | ì‹¤í–‰ ì‹¤íŒ¨ | `chmod +x` ì•ˆë‚´ |
| ì˜ëª»ëœ URL | ì •ê·œì‹ ê²€ì¦ | URL í˜•ì‹ ì•ˆë‚´ |
| ìë§‰ ì—†ìŒ | yt-dlp ì‘ë‹µ í™•ì¸ | ì–¸ì–´ ëª©ë¡ ì œì•ˆ |

---

## í™•ì¥ ê°€ëŠ¥ì„±

### ğŸš€ í–¥í›„ ê°œì„  ë°©í–¥

#### 1. ê¸°ëŠ¥ í™•ì¥
```python
# ë°°ì¹˜ ì²˜ë¦¬ ì§€ì›
def download_multiple_videos(self, urls: List[str]) -> Dict[str, bool]:
    results = {}
    for url in urls:
        results[url] = self.download_subtitles(url)
    return results

# ìë§‰ í›„ì²˜ë¦¬
def process_subtitles(self, srt_file: Path) -> Path:
    # ìë§‰ ì •ë¦¬, ë²ˆì—­, ìš”ì•½ ë“±
    pass
```

#### 2. API í†µí•©
```python
# YouTube Data API ì—°ë™
def get_video_metadata(self, video_id: str) -> Dict:
    # ì¡°íšŒìˆ˜, ì¢‹ì•„ìš”, ëŒ“ê¸€ ìˆ˜ ë“± ë©”íƒ€ë°ì´í„° ìˆ˜ì§‘
    pass

# ì±„ë„ ì •ë³´ ìˆ˜ì§‘
def get_channel_info(self, channel_id: str) -> Dict:
    # ì±„ë„ í†µê³„, ìµœì‹  ì˜ìƒ ëª©ë¡ ë“±
    pass
```

#### 3. ìë™í™” ì›Œí¬í”Œë¡œìš°
```python
# n8n ì—°ë™ì„ ìœ„í•œ JSON ì¶œë ¥
def export_results_json(self, results: Dict) -> str:
    return json.dumps(results, ensure_ascii=False, indent=2)

# ì›¹í›… ì§€ì›
def send_webhook(self, url: str, data: Dict) -> bool:
    # ì™„ë£Œ ì•Œë¦¼ ì „ì†¡
    pass
```

### ğŸ”§ ëª¨ë“ˆí™” ê°œì„ ì•ˆ

#### í˜„ì¬ êµ¬ì¡°
```
youtube_subtitle_downloader.py  # ë‹¨ì¼ íŒŒì¼
```

#### ê°œì„ ëœ êµ¬ì¡°
```
subtitle_downloader/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ core/
â”‚   â”œâ”€â”€ downloader.py      # í•µì‹¬ ë‹¤ìš´ë¡œë“œ ë¡œì§
â”‚   â”œâ”€â”€ validator.py       # URL ë° ì…ë ¥ ê²€ì¦
â”‚   â””â”€â”€ processor.py       # ìë§‰ í›„ì²˜ë¦¬
â”œâ”€â”€ utils/
â”‚   â”œâ”€â”€ logger.py          # ë¡œê¹… ìœ í‹¸ë¦¬í‹°
â”‚   â”œâ”€â”€ config.py          # ì„¤ì • ê´€ë¦¬
â”‚   â””â”€â”€ helpers.py         # í—¬í¼ í•¨ìˆ˜ë“¤
â””â”€â”€ cli/
    â””â”€â”€ main.py            # CLI ì¸í„°í˜ì´ìŠ¤
```

---

## ğŸ”¬ ì„±ëŠ¥ ìµœì í™”

### ğŸ“Š í˜„ì¬ ì„±ëŠ¥ íŠ¹ì„±
- **ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰**: ìµœì†Œ (ìŠ¤íŠ¸ë¦¬ë° ë‹¤ìš´ë¡œë“œ)
- **ë„¤íŠ¸ì›Œí¬ íš¨ìœ¨ì„±**: ë†’ìŒ (ìë§‰ë§Œ ë‹¤ìš´ë¡œë“œ)
- **CPU ì‚¬ìš©ëŸ‰**: ë‚®ìŒ (I/O ë°”ìš´ë“œ ì‘ì—…)

### âš¡ ìµœì í™” í¬ì¸íŠ¸
1. **ë³‘ë ¬ ì²˜ë¦¬**: ì—¬ëŸ¬ ì˜ìƒ ë™ì‹œ ë‹¤ìš´ë¡œë“œ
2. **ìºì‹±**: ì¤‘ë³µ ìš”ì²­ ë°©ì§€
3. **ì••ì¶•**: ëŒ€ìš©ëŸ‰ ìë§‰ íŒŒì¼ ì••ì¶• ì €ì¥
4. **ì¸ë±ì‹±**: ë‹¤ìš´ë¡œë“œ ì´ë ¥ ê´€ë¦¬

---

## ğŸ§ª í…ŒìŠ¤íŠ¸ ì „ëµ

### ë‹¨ìœ„ í…ŒìŠ¤íŠ¸ ì˜ˆì‹œ
```python
import unittest
from unittest.mock import patch, MagicMock

class TestYouTubeSubtitleDownloader(unittest.TestCase):
    
    def setUp(self):
        self.downloader = YouTubeSubtitleDownloader("./test_output")
    
    def test_validate_youtube_url(self):
        # ìœ íš¨í•œ URL í…ŒìŠ¤íŠ¸
        self.assertTrue(validate_youtube_url("https://www.youtube.com/watch?v=test"))
        self.assertTrue(validate_youtube_url("https://youtu.be/test"))
        
        # ë¬´íš¨í•œ URL í…ŒìŠ¤íŠ¸
        self.assertFalse(validate_youtube_url("https://vimeo.com/test"))
    
    @patch('yt_dlp.YoutubeDL')
    def test_download_subtitles_success(self, mock_ydl):
        # ì„±ê³µ ì¼€ì´ìŠ¤ ëª¨í‚¹
        mock_instance = MagicMock()
        mock_ydl.return_value.__enter__.return_value = mock_instance
        
        result = self.downloader.download_subtitles("https://youtube.com/test")
        self.assertTrue(result)
```

### í†µí•© í…ŒìŠ¤íŠ¸
```bash
#!/bin/bash
# integration_test.sh

# ì‹¤ì œ YouTube ì˜ìƒìœ¼ë¡œ í…ŒìŠ¤íŠ¸
TEST_URL="https://www.youtube.com/watch?v=dQw4w9WgXcQ"

echo "Testing basic download..."
./youtube-subs "$TEST_URL" --language en --output ./test_output

echo "Testing language listing..."
./youtube-subs "$TEST_URL" --list-languages

echo "Cleaning up..."
rm -rf ./test_output
```

---

## ğŸ“š ì°¸ê³  ìë£Œ

### í•µì‹¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¬¸ì„œ
- [yt-dlp Documentation](https://github.com/yt-dlp/yt-dlp)
- [Python argparse](https://docs.python.org/3/library/argparse.html)
- [Bash Scripting Guide](https://tldp.org/LDP/Bash-Beginners-Guide/html/)

### ê´€ë ¨ í‘œì¤€
- [SRT Subtitle Format](https://en.wikipedia.org/wiki/SubRip)
- [YouTube API Guidelines](https://developers.google.com/youtube/v3)
- [Clean Code Principles](https://clean-code-developer.com/)

---

**Made with ğŸ”§ for developers who care about clean, maintainable code**



